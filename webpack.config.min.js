const config = require('./webpack.config');
const webpack = require('webpack');
const ExtractTextPlugin = require("extract-text-webpack-plugin");
const path = require('path');

config.devtool = "none";

config.plugins = [
  new webpack.DefinePlugin({
    'process.env': {
      'NODE_ENV': JSON.stringify('production')
    },
  }),
  new ExtractTextPlugin("styles.css"),
  new webpack.optimize.UglifyJsPlugin({ minimize: true })
];

config.entry = [
  'babel-polyfill',
  './src/index'
];

config.module = {
  loaders: [{
    test: /\.(jsx|es)$/,
    loaders: ['react-hot', 'babel'],
    include: path.join(__dirname, 'src')
  }, {
    test: /\.css$/,
    loader: ExtractTextPlugin.extract([
        'css?modules&importLoaders=1&localIdentName=[name]__[local]___[hash:base64:5]',
        'postcss'
    ].join('!'))
  }]
}

module.exports = config;
